{% extends "base.html" %}
{% load static %}

{% block content %}
<section class="reservation-form">
    <div class="form-container">
        <h3>Gestión de Usuarios</h3>

        <form method="get" class="form-group" style="display: flex; flex-wrap: wrap; gap: 10px;">
            <input type="text" name="nombre" placeholder="Buscar por nombre" value="{{ filtro_nombre }}" class="input_field" style="width: 200px;">
            
            <select name="rol" class="input_field" style="width: 180px;">
                <option value="">Todos los roles</option>
                <option value="cliente" {% if filtro_rol == "cliente" %}selected{% endif %}>Cliente</option>
                <option value="recepcionista" {% if filtro_rol == "recepcionista" %}selected{% endif %}>Recepcionista</option>
                <option value="admin" {% if filtro_rol == "admin" %}selected{% endif %}>Administrador</option>
            </select>
            
            <button type="submit" class="reserve-btn" style="height: 42px;">Filtrar</button>
        </form>

        <table class="tabla-usuarios" style="margin-top: 20px; width: 100%;">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Apellido</th>
                    <th>Correo</th>
                    <th>Rol</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for usuario in usuarios %}
                <tr>
                    <td>{{ usuario.first_name }}</td>
                    <td>{{ usuario.last_name }}</td>
                    <td>{{ usuario.email }}</td>
                    <td>{{ usuario.rol }}</td>
                    <td>
                        {% if usuario != request.user %}
                        <a href="{% url 'editar_usuario' usuario.id %}" class="reserve-btn" style="background-color: #007bff;">Editar</a>
                        <a href="{% url 'eliminar_usuario' usuario.id %}" class="reserve-btn" style="background-color: #dc3545;">Eliminar</a>
                        {% else %}
                        <span style="color: #888;">No podés modificar tu propio rol</span>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">No se encontraron usuarios.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% endblock %}
